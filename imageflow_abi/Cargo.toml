[package]
name = "imageflow_abi"
version = "0.1.0"
authors = ["Lilith River <lilith@imazen.io>"]
workspace = "../"
build = "build.rs"
edition = "2021"

[lib]
name = "imageflow"
doc = true
# Default crate type for non-musl targets
crate-type = ["cdylib"]
doctest = false

# Override crate-type for musl targets
[target.'cfg(target_env = "musl")'.lib]
crate-type = ["staticlib"]

# Musl-specific settings - strip symbols since these are static builds
[target.'cfg(target_env = "musl")'.profile.release]
strip = true  # Strip symbols only for musl builds
lto = true    # Keep link-time optimization for better size/performance

[dependencies]
libc = "0.2"
imageflow_core = { path = "../imageflow_core", version = "*"}
backtrace = "*"
smallvec="*"
base64="0.22"

[build-dependencies]
imageflow_helpers = { path = "../imageflow_helpers", version = "*"}
cbindgen = "0.28"
regex = "1"

[features]
nightly = ["imageflow_core/nightly", "imageflow_helpers/nightly"]
